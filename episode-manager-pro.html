<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç®¡ç†Pro | å®Œå…¨è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #0099cc, #0077aa);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
        }
        
        .header h1 {
            margin: 0 0 1rem 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .header p {
            margin: 0;
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 2rem;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 2rem;
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 1rem;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: white;
            color: #0099cc;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .quick-add {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
        }
        
        .quick-add h2 {
            margin: 0 0 1rem 0;
            font-size: 1.8rem;
        }
        
        .notion-paste {
            background: white;
            border: 2px dashed #20c997;
            border-radius: 12px;
            padding: 2rem;
            margin: 1rem 0;
            min-height: 200px;
            font-family: monospace;
            font-size: 0.9rem;
            resize: vertical;
            width: 100%;
            box-sizing: border-box;
        }
        
        .notion-paste:focus {
            outline: none;
            border-color: #0099cc;
            box-shadow: 0 0 0 3px rgba(0, 153, 204, 0.1);
        }
        
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr auto auto;
            gap: 1rem;
            align-items: end;
            margin: 1rem 0;
        }
        
        .form-group {
            margin-bottom: 0;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        input, select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }
        
        .btn {
            background: #0099cc;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn:hover {
            background: #0077aa;
            transform: translateY(-1px);
        }
        
        .btn.success {
            background: #28a745;
        }
        
        .btn.success:hover {
            background: #218838;
        }
        
        .btn.danger {
            background: #dc3545;
        }
        
        .btn.danger:hover {
            background: #c82333;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .preview {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 2rem;
            margin: 1rem 0;
            display: none;
        }
        
        .preview.show {
            display: block;
        }
        
        .preview h3 {
            margin-top: 0;
            color: #0099cc;
        }
        
        .episode-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1rem;
        }
        
        .episode-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .episode-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .episode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0099cc, #667eea);
        }
        
        .episode-number {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .episode-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .episode-meta {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
        }
        
        .episode-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            border-radius: 6px;
        }
        
        .output {
            background: #1a1a1a;
            color: #00ff00;
            border-radius: 8px;
            padding: 1.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            margin: 1rem 0;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0099cc;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }
        
        .success-message.show {
            display: block;
        }
        
        .batch-upload {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            margin: 2rem 0;
        }
        
        .drop-zone {
            border: 3px dashed rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 3rem;
            text-align: center;
            margin: 1rem 0;
            transition: all 0.3s;
        }
        
        .drop-zone.dragover {
            border-color: rgba(255,255,255,0.8);
            background: rgba(255,255,255,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç®¡ç†Pro</h1>
            <p>Notionã‹ã‚‰ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§è¨˜äº‹å¤‰æ›ãƒ»è‡ªå‹•æŠ•ç¨¿ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>
        
        <div class="main-content">
            <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab(0)">ğŸ¯ ã‚¯ã‚¤ãƒƒã‚¯è¿½åŠ </button>
                <button class="tab" onclick="switchTab(1)">ğŸ“Š çµ±è¨ˆãƒ»ç®¡ç†</button>
                <button class="tab" onclick="switchTab(2)">ğŸ”„ ãƒãƒƒãƒå‡¦ç†</button>
                <button class="tab" onclick="switchTab(3)">âš™ï¸ è¨­å®š</button>
            </div>
            
            <!-- ã‚¿ãƒ–1: ã‚¯ã‚¤ãƒƒã‚¯è¿½åŠ  -->
            <div class="tab-content active">
                <div class="quick-add">
                    <h2>âš¡ Notionè¨˜äº‹ã‚’å³åº§ã«å¤‰æ›</h2>
                    <p>Notionãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„</p>
                    
                    <div class="controls">
                        <div class="form-group">
                            <label for="series">ã‚·ãƒªãƒ¼ã‚º:</label>
                            <select id="series">
                                <option value="europe2025">ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘2025 (138-164è©±)</option>
                                <option value="europe2025_2">ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘2025â‘¡ (165-253è©±)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="episodeNum">ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç•ªå·:</label>
                            <input type="number" id="episodeNum" min="138" max="253" placeholder="ä¾‹: 169">
                        </div>
                        
                        <button class="btn success" onclick="autoConvert()">ğŸª„ è‡ªå‹•å¤‰æ›</button>
                        <button class="btn" onclick="previewEpisode()">ğŸ‘€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                    </div>
                    
                    <textarea 
                        class="notion-paste" 
                        id="notionText" 
                        placeholder="ã“ã“ã«Notionãƒšãƒ¼ã‚¸ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒšã—ã¦ãã ã•ã„...

ä¾‹:
# ã‚¹ãƒˆãƒƒã‚¯ãƒ›ãƒ«ãƒ ã®ç¾ã—ã„æœ

2025å¹´2æœˆ6æ—¥ ğŸ‡¸ğŸ‡ª ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³

ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³ã®é¦–éƒ½ã‚¹ãƒˆãƒƒã‚¯ãƒ›ãƒ«ãƒ ã§è¿ãˆã‚‹æœã¯æ ¼åˆ¥ã§ã—ãŸã€‚

## åŒ—æ¬§ã®é­…åŠ›
- æ¸…æ½”ã§ç¾ã—ã„è¡—ä¸¦ã¿
- ç’°å¢ƒã«é…æ…®ã—ãŸè¨­è¨ˆ

ç”»åƒURLã‚‚è‡ªå‹•ã§å‡¦ç†ã•ã‚Œã¾ã™ï¼"
                    ></textarea>
                </div>
                
                <div class="loading">
                    <div class="spinner"></div>
                    <p>ğŸ”„ Notionè¨˜äº‹ã‚’å¤‰æ›ä¸­...</p>
                </div>
                
                <div class="success-message">
                    <h4>âœ… å¤‰æ›å®Œäº†ï¼</h4>
                    <p id="successText"></p>
                </div>
                
                <div class="preview">
                    <h3>ğŸ“– ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
                    <div id="previewContent"></div>
                </div>
                
                <div class="output" id="output"></div>
            </div>
            
            <!-- ã‚¿ãƒ–2: çµ±è¨ˆãƒ»ç®¡ç† -->
            <div class="tab-content">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalEpisodes">0</div>
                        <div class="stat-label">ç·ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="europe2025Count">0</div>
                        <div class="stat-label">ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘2025ç·¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="europe2025_2Count">0</div>
                        <div class="stat-label">ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘2025â‘¡ç·¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="imagesCount">0</div>
                        <div class="stat-label">å‡¦ç†æ¸ˆã¿ç”»åƒæ•°</div>
                    </div>
                </div>
                
                <h2>ğŸ“š æ—¢å­˜ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ä¸€è¦§</h2>
                <div id="episodeList" class="episode-list"></div>
            </div>
            
            <!-- ã‚¿ãƒ–3: ãƒãƒƒãƒå‡¦ç† -->
            <div class="tab-content">
                <div class="batch-upload">
                    <h2>ğŸ”„ ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h2>
                    <p>è¤‡æ•°ã®Notionè¨˜äº‹ã‚’ä¸€åº¦ã«å‡¦ç†ã§ãã¾ã™</p>
                    
                    <div class="drop-zone" id="dropZone">
                        <h3>ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ— ã¾ãŸã¯ ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</h3>
                        <p>è¤‡æ•°ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«(.txt)ã‚’ã¾ã¨ã‚ã¦å‡¦ç†</p>
                        <input type="file" id="fileInput" multiple accept=".txt" style="display: none;">
                    </div>
                    
                    <button class="btn" onclick="document.getElementById('fileInput').click()">
                        ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
                    </button>
                    <button class="btn success" onclick="processBatch()">
                        ğŸš€ ä¸€æ‹¬å¤‰æ›é–‹å§‹
                    </button>
                </div>
            </div>
            
            <!-- ã‚¿ãƒ–4: è¨­å®š -->
            <div class="tab-content">
                <h2>âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</h2>
                
                <div class="form-group">
                    <label>GitHubè‡ªå‹•ã‚³ãƒŸãƒƒãƒˆ:</label>
                    <label>
                        <input type="checkbox" id="autoCommit" checked> 
                        å¤‰æ›å¾Œã«GitHubã¸è‡ªå‹•ãƒ—ãƒƒã‚·ãƒ¥
                    </label>
                </div>
                
                <div class="form-group">
                    <label>ç”»åƒæœ€é©åŒ–:</label>
                    <label>
                        <input type="checkbox" id="optimizeImages" checked> 
                        ç”»åƒã‚’è‡ªå‹•ã§WebPå½¢å¼ã«å¤‰æ›
                    </label>
                </div>
                
                <div class="form-group">
                    <label>é€šçŸ¥è¨­å®š:</label>
                    <label>
                        <input type="checkbox" id="notifications" checked> 
                        å¤‰æ›å®Œäº†æ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥
                    </label>
                </div>
                
                <button class="btn" onclick="exportSettings()">ğŸ“‹ è¨­å®šã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                <button class="btn danger" onclick="resetAll()">ğŸ—‘ï¸ å…¨ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ</button>
            </div>
        </div>
    </div>
    
    <script src="./assets/js/episodes-content.js"></script>
    <script>
        class EpisodeManagerPro {
            constructor() {
                this.currentTab = 0;
                this.processedImages = 0;
                this.init();
            }
            
            init() {
                this.updateStats();
                this.displayEpisodes();
                this.setupDragAndDrop();
                this.requestNotificationPermission();
            }
            
            // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
            switchTab(index) {
                // ã™ã¹ã¦ã®ã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
                document.querySelectorAll('.tab')[index].classList.add('active');
                document.querySelectorAll('.tab-content')[index].classList.add('active');
                
                this.currentTab = index;
            }
            
            // Notionè¨˜äº‹ã‚’è‡ªå‹•å¤‰æ›
            async autoConvert() {
                const notionText = document.getElementById('notionText').value.trim();
                const episodeNumber = document.getElementById('episodeNum').value;
                const series = document.getElementById('series').value;
                
                if (!notionText || !episodeNumber) {
                    alert('Notionãƒ†ã‚­ã‚¹ãƒˆã¨ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                    return;
                }
                
                this.showLoading(true);
                this.log('ğŸš€ å¤‰æ›é–‹å§‹...');
                
                try {
                    // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
                    const metadata = this.extractMetadata(notionText);
                    this.log(`ğŸ“Š ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿: ${metadata.title || 'ç„¡é¡Œ'}`);
                    
                    // HTMLå¤‰æ›
                    let html = this.convertToHTML(notionText);
                    this.log('ğŸ”„ HTMLå¤‰æ›å®Œäº†');
                    
                    // ç”»åƒå‡¦ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                    html = await this.processImages(html, episodeNumber);
                    
                    // ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ä½œæˆ
                    const episode = {
                        title: metadata.title || `ç¬¬${episodeNumber}è©±`,
                        date: metadata.date || new Date().toLocaleDateString('ja-JP'),
                        location: metadata.location || this.getDefaultLocation(series, episodeNumber),
                        content: html
                    };
                    
                    // episodes-content.jsã«è¿½åŠ ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
                    this.addEpisodeToContent(episode, episodeNumber, series);
                    
                    this.showLoading(false);
                    this.showSuccess(`âœ… ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰${episodeNumber}: ${episode.title} ãŒæ­£å¸¸ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸï¼`);
                    
                    // é€šçŸ¥
                    if (document.getElementById('notifications').checked) {
                        this.showNotification('ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰è¿½åŠ å®Œäº†', `ç¬¬${episodeNumber}è©±ãŒæ­£å¸¸ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸ`);
                    }
                    
                    // çµ±è¨ˆæ›´æ–°
                    this.updateStats();
                    
                    // ãƒ•ã‚©ãƒ¼ãƒ ã‚¯ãƒªã‚¢
                    document.getElementById('notionText').value = '';
                    document.getElementById('episodeNum').value = '';
                    
                } catch (error) {
                    this.showLoading(false);
                    this.log(`âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                }
            }
            
            // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
            extractMetadata(text) {
                const metadata = { title: '', date: '', location: '' };
                
                // ã‚¿ã‚¤ãƒˆãƒ«æŠ½å‡º
                const titleMatch = text.match(/^#\s*(.+)$/m) || text.match(/^(.+)$/m);
                if (titleMatch) {
                    metadata.title = titleMatch[1].trim().replace(/^[\d]+[:ï¼š]\s*/, '');
                }
                
                // æ—¥ä»˜æŠ½å‡º
                const dateMatch = text.match(/(\d{4}å¹´\d{1,2}æœˆ\d{1,2}æ—¥)/);
                if (dateMatch) {
                    metadata.date = dateMatch[1];
                }
                
                // å ´æ‰€æŠ½å‡º
                const locationMatch = text.match(/([ğŸ‡¦-ğŸ‡¿]{2}\s*[^\n\r]+)/);
                if (locationMatch) {
                    metadata.location = locationMatch[1].trim();
                }
                
                return metadata;
            }
            
            // HTMLå¤‰æ›
            convertToHTML(text) {
                return text
                    .replace(/^# (.+)$/gm, '<h2>$1</h2>')
                    .replace(/^## (.+)$/gm, '<h3>$1</h3>')
                    .replace(/^### (.+)$/gm, '<h4>$1</h4>')
                    .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.+?)\*/g, '<em>$1</em>')
                    .replace(/^- (.+)$/gm, '<li>$1</li>')
                    .replace(/^> (.+)$/gm, '<blockquote>$1</blockquote>')
                    .replace(/^(?!<[^>]+>)(.+)$/gm, '<p>$1</p>')
                    .replace(/<p><\/p>/g, '')
                    .replace(/(<li>.*<\/li>)+/g, '<ul>$&</ul>')
                    .replace(/<\/li><li>/g, '</li>\n<li>');
            }
            
            // ç”»åƒå‡¦ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            async processImages(html, episodeNumber) {
                const imageRegex = /(https?:\/\/[^\s]+\.(?:jpg|jpeg|png|gif|webp))/gi;
                const images = html.match(imageRegex) || [];
                
                for (let i = 0; i < images.length; i++) {
                    const imageUrl = images[i];
                    const localPath = `assets/images/episodes/episode-${episodeNumber}-${i + 1}.jpg`;
                    
                    // å‡¦ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                    await new Promise(resolve => setTimeout(resolve, 200));
                    this.log(`ğŸ“¸ ç”»åƒå‡¦ç†: ${imageUrl} -> ${localPath}`);
                    
                    html = html.replace(imageUrl, localPath);
                    this.processedImages++;
                }
                
                return html;
            }
            
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå ´æ‰€å–å¾—
            getDefaultLocation(series, episodeNumber) {
                if (series === 'europe2025_2') {
                    if (episodeNumber >= 165 && episodeNumber <= 167) return 'ğŸ‡©ğŸ‡° ãƒ‡ãƒ³ãƒãƒ¼ã‚¯';
                    if (episodeNumber >= 168 && episodeNumber <= 178) return 'ğŸ‡¸ğŸ‡ª ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³';
                    if (episodeNumber >= 179 && episodeNumber <= 187) return 'ğŸ‡µğŸ‡± ãƒãƒ¼ãƒ©ãƒ³ãƒ‰';
                    if (episodeNumber >= 188 && episodeNumber <= 195) return 'ğŸ‡³ğŸ‡´ ãƒãƒ«ã‚¦ã‚§ãƒ¼';
                    if (episodeNumber >= 196 && episodeNumber <= 201) return 'ğŸ‡®ğŸ‡ª ã‚¢ã‚¤ãƒ«ãƒ©ãƒ³ãƒ‰';
                    if (episodeNumber >= 202 && episodeNumber <= 207) return 'ğŸ‡¦ğŸ‡ª ãƒ‰ãƒã‚¤';
                    if (episodeNumber >= 208 && episodeNumber <= 225) return 'ğŸ‡«ğŸ‡· ãƒ•ãƒ©ãƒ³ã‚¹';
                    if (episodeNumber >= 226 && episodeNumber <= 231) return 'ğŸ‡¯ğŸ‡µğŸ‡¨ğŸ‡³ æ—¥æœ¬ãƒ»ä¸Šæµ·';
                    if (episodeNumber >= 232 && episodeNumber <= 243) return 'ğŸ‡±ğŸ‡»ğŸ‡±ğŸ‡¹ğŸ‡ªğŸ‡ª ãƒãƒ«ãƒˆä¸‰å›½';
                    if (episodeNumber >= 244 && episodeNumber <= 253) return 'ğŸ‡¬ğŸ‡§ ã‚¤ã‚®ãƒªã‚¹';
                }
                return series === 'europe2025' ? 'ğŸ‡®ğŸ‡ª ã‚¢ã‚¤ãƒ«ãƒ©ãƒ³ãƒ‰' : 'ğŸŒ ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘';
            }
            
            // ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰è¿½åŠ ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
            addEpisodeToContent(episode, episodeNumber, series) {
                this.log(`ğŸ“ episodes-content.jsã«è¿½åŠ ä¸­...`);
                this.log(`${episodeNumber}: ${episode.title}`);
                this.log(`ğŸ“… ${episode.date} | ğŸ“ ${episode.location}`);
                
                // å®Ÿéš›ã®å‡¦ç†ã§ã¯ã€ã“ã“ã§ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿
                const code = `        ${episodeNumber}: {
            title: "${episodeNumber}:${episode.title}",
            date: "${episode.date}",
            location: "${episode.location}",
            content: \`${episode.content.substring(0, 100)}...\`
        },`;
                
                this.log('ğŸ“‹ ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰:');
                this.log(code);
            }
            
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
            previewEpisode() {
                const notionText = document.getElementById('notionText').value.trim();
                if (!notionText) {
                    alert('ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚');
                    return;
                }
                
                const metadata = this.extractMetadata(notionText);
                const html = this.convertToHTML(notionText);
                
                const preview = document.querySelector('.preview');
                const content = document.getElementById('previewContent');
                
                content.innerHTML = `
                    <h4>${metadata.title || 'ç„¡é¡Œ'}</h4>
                    <p><strong>æ—¥ä»˜:</strong> ${metadata.date || 'æœªè¨­å®š'}</p>
                    <p><strong>å ´æ‰€:</strong> ${metadata.location || 'æœªè¨­å®š'}</p>
                    <hr>
                    <div>${html}</div>
                `;
                
                preview.classList.add('show');
            }
            
            // çµ±è¨ˆæ›´æ–°
            updateStats() {
                const europe2025Count = Object.keys(EPISODES_CONTENT.europe2025 || {}).length;
                const europe2025_2Count = Object.keys(EPISODES_CONTENT.europe2025_2 || {}).length;
                const totalCount = europe2025Count + europe2025_2Count;
                
                document.getElementById('totalEpisodes').textContent = totalCount;
                document.getElementById('europe2025Count').textContent = europe2025Count;
                document.getElementById('europe2025_2Count').textContent = europe2025_2Count;
                document.getElementById('imagesCount').textContent = this.processedImages;
            }
            
            // ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ä¸€è¦§è¡¨ç¤º
            displayEpisodes() {
                const container = document.getElementById('episodeList');
                container.innerHTML = '';
                
                ['europe2025', 'europe2025_2'].forEach(seriesKey => {
                    const episodes = EPISODES_CONTENT[seriesKey] || {};
                    const seriesName = seriesKey === 'europe2025' ? 'ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘2025' : 'ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘2025â‘¡';
                    
                    Object.entries(episodes).forEach(([episodeNum, episode]) => {
                        const card = document.createElement('div');
                        card.className = 'episode-card';
                        card.innerHTML = `
                            <div class="episode-number">${seriesName} ç¬¬${episodeNum}è©±</div>
                            <div class="episode-title">${episode.title}</div>
                            <div class="episode-meta">
                                <span>ğŸ“… ${episode.date}</span>
                                <span>ğŸ“ ${episode.location}</span>
                            </div>
                            <div class="episode-actions">
                                <button class="btn btn-small" onclick="manager.viewEpisode('${seriesKey}', ${episodeNum})">
                                    ğŸ‘€ ç¢ºèª
                                </button>
                                <button class="btn btn-small success" onclick="manager.editEpisode('${seriesKey}', ${episodeNum})">
                                    âœï¸ ç·¨é›†
                                </button>
                            </div>
                        `;
                        container.appendChild(card);
                    });
                });
            }
            
            // ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç¢ºèª
            viewEpisode(series, episodeNumber) {
                const countryParam = series === 'europe2025' ? 'europe2025' : 'europe2025-2';
                window.open(`episode-template.html?episode=${episodeNumber}&country=${countryParam}`, '_blank');
            }
            
            // ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ç·¨é›†
            editEpisode(series, episodeNumber) {
                this.switchTab(0);
                
                const episode = EPISODES_CONTENT[series][episodeNumber];
                document.getElementById('series').value = series;
                document.getElementById('episodeNum').value = episodeNumber;
                
                // é€†å¤‰æ›ã—ã¦Notionãƒ†ã‚­ã‚¹ãƒˆã£ã½ãå¾©å…ƒ
                const notionText = this.htmlToNotionText(episode.content, episode.title, episode.date, episode.location);
                document.getElementById('notionText').value = notionText;
            }
            
            // HTMLâ†’Notionãƒ†ã‚­ã‚¹ãƒˆé€†å¤‰æ›
            htmlToNotionText(html, title, date, location) {
                return html
                    .replace(/<h2>(.*?)<\/h2>/g, '# $1')
                    .replace(/<h3>(.*?)<\/h3>/g, '## $1')
                    .replace(/<h4>(.*?)<\/h4>/g, '### $1')
                    .replace(/<strong>(.*?)<\/strong>/g, '**$1**')
                    .replace(/<em>(.*?)<\/em>/g, '*$1*')
                    .replace(/<li>(.*?)<\/li>/g, '- $1')
                    .replace(/<blockquote>(.*?)<\/blockquote>/g, '> $1')
                    .replace(/<p>(.*?)<\/p>/g, '$1')
                    .replace(/<ul>|<\/ul>/g, '')
                    .replace(/\n+/g, '\n\n');
            }
            
            // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—è¨­å®š
            setupDragAndDrop() {
                const dropZone = document.getElementById('dropZone');
                
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('dragover');
                });
                
                dropZone.addEventListener('dragleave', () => {
                    dropZone.classList.remove('dragover');
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('dragover');
                    
                    const files = Array.from(e.dataTransfer.files);
                    this.handleFiles(files);
                });
                
                dropZone.addEventListener('click', () => {
                    document.getElementById('fileInput').click();
                });
                
                document.getElementById('fileInput').addEventListener('change', (e) => {
                    this.handleFiles(Array.from(e.target.files));
                });
            }
            
            // ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
            async handleFiles(files) {
                this.log(`ğŸ“ ${files.length}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ä¸­...`);
                
                for (const file of files) {
                    if (file.type === 'text/plain') {
                        const content = await this.readFile(file);
                        this.log(`ğŸ“„ ${file.name} ã‚’èª­ã¿è¾¼ã¿å®Œäº†`);
                        // ã“ã“ã§è‡ªå‹•å¤‰æ›å‡¦ç†ã‚’å®Ÿè¡Œ
                    }
                }
            }
            
            // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
            readFile(file) {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.readAsText(file);
                });
            }
            
            // ãƒ­ã‚°å‡ºåŠ›
            log(message) {
                const output = document.getElementById('output');
                const timestamp = new Date().toLocaleTimeString();
                output.textContent += `[${timestamp}] ${message}\n`;
                output.scrollTop = output.scrollHeight;
            }
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            showLoading(show) {
                const loading = document.querySelector('.loading');
                loading.classList.toggle('show', show);
            }
            
            // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
            showSuccess(message) {
                const success = document.querySelector('.success-message');
                document.getElementById('successText').textContent = message;
                success.classList.add('show');
                
                setTimeout(() => success.classList.remove('show'), 5000);
            }
            
            // é€šçŸ¥æ¨©é™è¦æ±‚
            requestNotificationPermission() {
                if ('Notification' in window && Notification.permission === 'default') {
                    Notification.requestPermission();
                }
            }
            
            // é€šçŸ¥è¡¨ç¤º
            showNotification(title, body) {
                if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification(title, { body, icon: 'assets/images/profile.jpg' });
                }
            }
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
        function switchTab(index) {
            window.manager.switchTab(index);
        }
        
        function autoConvert() {
            window.manager.autoConvert();
        }
        
        function previewEpisode() {
            window.manager.previewEpisode();
        }
        
        function processBatch() {
            window.manager.log('ğŸ”„ ãƒãƒƒãƒå‡¦ç†æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™...');
        }
        
        function exportSettings() {
            window.manager.log('ğŸ“‹ è¨­å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™...');
        }
        
        function resetAll() {
            if (confirm('æœ¬å½“ã«å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                window.manager.log('ğŸ—‘ï¸ ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™...');
            }
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            window.manager = new EpisodeManagerPro();
        });
    </script>
</body>
</html>